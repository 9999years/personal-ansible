---
- name: Check for pip binary
  stat:
      path: '{{ pip_bin }}'
  register: pip_stat
  changed_when: not (pip_stat.stat.exists and pip_stat.stat.executable)

- when: pip_stat is changed
  block:
  - name: Create temporary file for installer
    tempfile:
        suffix: .py
    register: get_pip_tmp

  - name: Download get-pip.py
    get_url:
        dest: '{{ get_pip_tmp.path }}'
        mode: 0755
        url: '{{ bootstrap_pip_url }}'

  - name: Execute get-pip.py
    command: '{{ python_bin }} {{ get_pip_tmp.path }}'
